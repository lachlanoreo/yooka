
<h1 class="absolute-header"><%= current_user.first_name.capitalize %> <%= current_user.last_name.capitalize %></h1>



<%= cl_image_tag current_user.photo.key, :gravity=>"faces", :crop=>"fill", class: "avatar-bordered feature-avatar m-1", alt: "avatar-large" %>

<%# journey %>

<% if @journeys.length > 0 %>
    <h2>Your current journey:</h2>
    <%= link_to journey_path(@journeys.last) do %>
            <div class="lesson-card">
                <img src="https://images.unsplash.com/photo-1579273166152-d725a4e2b755?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=500&q=60" />
                <div class="lesson-card-infos">
                    <h2><%= @journeys.last.name %></h2>
                </div>
            </div>
    <% end %>
    <div class="dashboard-element dashboard-progress">
        <div><p>Progress: <%= @journey_progress %>%</p></div>
        <div class="progress">
            <div class="progress-bar" role="progressbar" style="width: <%= @journey_progress %>%" aria-valuenow="<%= @journey_progress %>" aria-valuemin="0" aria-valuemax="100"></div>
        </div>
    </div>
<% end %>

<div class="d-flex flex-wrap">
<%# badges %>
    <div class="dashboard-element">
        <% if  @user_badges %>



        <% if  @user_badges.length > 0 %>
            <h2>Badges:</h2>
            <div class="user-badges d-flex flex-wrap justify-content-start">
                <% @user_badges.each do |user_badge| %>
                    <div class="d-flex align-items-center flex-column user-badge">
                        <%= image_tag "badges/#{user_badge.badge.name.gsub(/\s+/, "")}.png", alt: user_badge.badge.name %>
                        <p class="mb-auto"><%= user_badge.badge.name %></p>
                    </div>
                <% end %>
            </div>
        <% else %>
            <h3>You currently have no badges</h3>

            <% if  @user_badges.length > 0 %>
                <h2>Badges:</h2>
                <div class="user-badges d-flex flex-wrap justify-content-start">
                    <% @user_badges.each do |user_badge| %>
                        <div class="d-flex align-items-center flex-column user-badge">
                            <%= image_tag "badges/#{user_badge.badge.name.gsub(/\s+/, "")}.png", alt: user_badge.badge.name %>
                            <p class="mb-auto"><%= user_badge.badge.name %></p>
                        </div>
                    <% end %>
                </div>
            <% else %>
                <h3>You currently have no badges</h3>
            <% end %>

        <% end %>
        <% end %>
        <%# xp %>

        <div class="d-flex xp-streak">
            <div class="dashboard-element xp">
                <h4><i class="fas fa-gem"></i> points: 
                    <% if current_user.xp %>
                        <%= current_user.xp %>
                    <% else %>
                        0  
                    <% end %>
                </h4>
            </div>
            <div class="dashboard-element streak">
                <h4><i class="fas fa-fire-alt"></i> <%= @streak %> day streak</h4>
            </div>
        </div>

<div class="d-flex xp-streak">
    <div class="dashboard-element xp">
        <h4><i class="fas fa-gem"></i> points:
            <% if current_user.xp %>
                <%= current_user.xp %>
            <% else %>
                0
            <% end %>
        </h4>

        <%= link_to "Log Sleep", journey_habits_create_path, class: "btn btn-main" %>
    </div>


    <div class="dashboard-leaderboard dashboard-element">
        <h4>Challenge Leaderboard</h4>
        <table class="table">
            <tr>
                <th scope="col">User</th><th scope="col">Points</th>
            </tr>
                <% leaderboard_counter = 1 %>
                <% @short_leaderboard.each do |user| %>
                    <tr>
                        <td><%= leaderboard_counter %>. <%= user.first_name %></td>
                        <td><%= user.xp %></td>
                        <% leaderboard_counter += 1 %>
                    </tr>
                <% end %>
        </table>
    </div>
</div>



